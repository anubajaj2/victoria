sap.ui.define(["jquery.sap.global","sap/ui/core/mvc/Controller","sap/ui/core/routing/History","sap/ui/model/json/JSONModel","victoria/dbapi/dbapi","sap/m/MessageBox","sap/m/MessagePopover","sap/m/MessageToast","sap/m/MessageItem","victoria/models/formatter","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(e,t,r,a,s,i,o,l,n,d,u,g){"use strict";var p;var c;var h;var m;var f;return t.extend("victoria.controller.BaseController",{formatter:d,ODataHelper:s,secureToken:"",currentUser:"",bUserTestcases:true,oViewModel:undefined,oMasterList:undefined,oMasterPage:undefined,oDetailPage:undefined,oViewTable:undefined,oEditTable:undefined,oEventBus:undefined,oTestcaseListModel:undefined,sUrlTargetSystem:undefined,toggleTableState:true,deduction:0,DeductionCash:0,DeductionGold:0,DeductionSilver:0,allMasterData:{customers:[],customersId:[],materials:[],materialsId:[],orderHeader:[],wholeSaleHeader:[],customCalculations:[],cities:[],users:[],stockItems:[],groups:[]},onInit:function(){debugger;var e=this;this.ODataHelper.callOData(this.getOwnerComponent().getModel(),"/StockItems","GET",null,null,this).then(function(t){for(var r=0;r<t.results.length;r++){e.allMasterData.stockItems[t.results[r].OrderNo]=t.results[r]}}).catch(function(t){var r=e.getErrorMessage(t)});this.ODataHelper.callOData(this.getOwnerComponent().getModel(),"/AppUsers","GET",null,null,this).then(function(t){for(var r=0;r<t.results.length;r++){e.allMasterData.users[t.results[r].TechnicalId]=t.results[r]}}).catch(function(t){var r=e.getErrorMessage(t)});this.ODataHelper.callOData(this.getOwnerComponent().getModel(),"/WSOrderHeaders","GET",null,null,this).then(function(t){for(var r=0;r<t.results.length;r++){e.allMasterData.wholeSaleHeader[t.results[r].id]=t.results[r]}}).catch(function(t){var r=e.getErrorMessage(t)});this.ODataHelper.callOData(this.getOwnerComponent().getModel(),"/OrderHeaders","GET",null,null,this).then(function(t){for(var r=0;r<t.results.length;r++){e.allMasterData.orderHeader[t.results[r].id]=t.results[r]}}).catch(function(t){var r=e.getErrorMessage(t)});this.ODataHelper.callOData(this.getOwnerComponent().getModel(),"/Customers","GET",null,null,this).then(function(t){for(var r=0;r<t.results.length;r++){e.allMasterData.customers[t.results[r].id]=t.results[r];e.allMasterData.customersId[t.results[r].CustomerCode]=t.results[r]}var a=e.getModel("local").getProperty("/CurrentUser");if(e.getModel("local").oData.AppUsers[a].Role!=="Admin"){debugger;var s=new u([new sap.ui.model.Filter("CustomerCode",sap.ui.model.FilterOperator.EQ,"")],true);e.getView().byId("idTable1").getBinding("items").filter(s);e.getView().setBusy(false);var i=e.allMasterData.customers;var o=[];function l(e){return Object.keys(e).length}debugger;for(var n in i){var d=i[n].Group;var g=e.allMasterData.groups[d].hide;if(g===false){o.push(i[n])}}debugger;debugger;e.getView().getModel("local").setProperty("/finalCustomer",o)}else{debugger;function l(e){return Object.keys(e).length}var i=e.allMasterData.customers;var p=l(i);var c=[];for(var n in i){c.push(i[n])}debugger;e.getView().getModel("local").setProperty("/finalCustomer",c)}}).catch(function(t){var r=e.getErrorMessage(t)});this.ODataHelper.callOData(this.getOwnerComponent().getModel(),"/Products","GET",null,null,this).then(function(t){for(var r=0;r<t.results.length;r++){e.allMasterData.materials[t.results[r].id]=t.results[r];e.allMasterData.materialsId[t.results[r].ProductCode]=t.results[r]}}).catch(function(t){var r=e.getErrorMessage(t)});this.ODataHelper.callOData(this.getOwnerComponent().getModel(),"/Cities","GET",null,null,this).then(function(t){for(var r=0;r<t.results.length;r++){e.allMasterData.cities[t.results[r].id]=t.results[r]}}).catch(function(t){var r=e.getErrorMessage(t)});this.ODataHelper.callOData(this.getOwnerComponent().getModel(),"/Groups","GET",null,null,this).then(function(t){for(var r=0;r<t.results.length;r++){e.allMasterData.groups[t.results[r].id]=t.results[r]}}).catch(function(t){var r=e.getErrorMessage(t)});this.fetchValuesFromCustomizing()},onAfterRendering:function(){$("input[type='Number']").focus(function(){$(this).select()})},onBeforeShow:function(e){alert("hello")},fetchValuesFromCustomizing:function(){var e=this;this.ODataHelper.callOData(this.getOwnerComponent().getModel(),"/CustomCalculations","GET",null,null,this).then(function(t){for(var r=0;r<t.results.length;r++){e.allMasterData.customCalculations[t.results[r].id]=t.results[r]}}).catch(function(t){var r=e.getErrorMessage(t)})},getRouter:function(){return this.getOwnerComponent().getRouter()},getCurrentUser:function(){return this.currentUser},logOutApp:function(e){debugger;var t=this;var r=t.getView().getModel().getHeaders().Authorization;if(r){$.post("/api/Users/logout?access_token="+r,{}).done(function(r,a){t.getView().getModel("local").setProperty("/Authorization","");t.getView().getModel().setHeaders({Authorization:""});t.redirectLoginPage("X",e)}).fail(function(e,t,r){sap.m.MessageBox.error("Logout failed")})}else{t.redirectLoginPage("X",e)}},getCustomerPopup:function(e){if(!this.searchPopup){var t=this;this.searchPopup=new sap.ui.xmlfragment("victoria.fragments.popup",this);this.getView().addDependent(this.searchPopup);var r=this.getView().getModel("i18n").getProperty("customer");this.searchPopup.setTitle(r);this.searchPopup.bindAggregation("items",{path:"/Customers",template:new sap.m.DisplayListItem({label:"{CustomerCode}",value:{parts:[{path:"Name"},{path:"City"}],formatter:function(e,r){return e+"-"+t.allMasterData.cities[r].cityName}}}),sorter:new sap.ui.model.Sorter("CustomerCode")})}this.searchPopup.open()},onSearch:function(e){var t=e.getParameter("value");r=[];if(!t){t=e.getParameter("newValue")}if(t){var r=new sap.ui.model.Filter({filters:[new sap.ui.model.Filter("CustomerCode",sap.ui.model.FilterOperator.Contains,t.toUpperCase()),new sap.ui.model.Filter("Name",sap.ui.model.FilterOperator.Contains,t.toUpperCase())],and:false})}this.searchPopup.getBinding("items").filter(r)},getKachhiCustPopup:function(e){if(!this.kCustomersearchPopup){this.kCustomersearchPopup=new sap.ui.xmlfragment("victoria.fragments.popup",this);this.getView().addDependent(this.kCustomersearchPopup);var t=this.getView().getModel("i18n").getProperty("customer");this.kCustomersearchPopup.setTitle(t);var r=new sap.ui.model.Filter("Type",sap.ui.model.FilterOperator.EQ,"Kata Center");this.kCustomersearchPopup.bindAggregation("items",{path:"/Customers",filters:[r],template:new sap.m.DisplayListItem({label:"{CustomerCode}",value:"{Name} - {city}"})})}this.kCustomersearchPopup.open()},getKarigarPopup:function(e){var t=this;if(!this.karigarsearchPopup){this.karigarsearchPopup=new sap.ui.xmlfragment("victoria.fragments.popup",this);this.getView().addDependent(this.karigarsearchPopup);var r=this.getView().getModel("i18n").getProperty("karigarSearch");this.karigarsearchPopup.setTitle(r);var a=new sap.ui.model.Filter("Type",sap.ui.model.FilterOperator.EQ,"Karigar");this.karigarsearchPopup.bindAggregation("items",{path:"/Customers",template:new sap.m.DisplayListItem({label:"{CustomerCode}",value:{parts:[{path:"Name"},{path:"City"}],formatter:function(e,r){debugger;return e+"-"+t.allMasterData.cities[r].cityName}}})})}this.karigarsearchPopup.open()},orderPopup:function(e){this.orderSearchPopup=new sap.ui.xmlfragment("victoria.fragments.popup",this);var t=this.getView().getModel("i18n").getProperty("orderSearch");this.orderSearchPopup.setTitle(t);var r=this.byId("Sales--DateId").getValue();var a=this.getView().getModel("local").getProperty("/orderHeader").Customer;var s=new Date(r);s.setHours(0,0,0,1);var i=new Date(r);i.setHours(23,59,59,59);var o=new sap.ui.model.Filter("Date",sap.ui.model.FilterOperator.GE,s);var l=new sap.ui.model.Filter("Date",sap.ui.model.FilterOperator.LE,i);if(a){var n=new sap.ui.model.Filter("Customer",sap.ui.model.FilterOperator.EQ,a)}else{var n=new sap.ui.model.Filter("Customer",sap.ui.model.FilterOperator.EQ,"")}debugger;var d=new sap.ui.model.Filter({filters:[o,l],and:true});var u=new sap.ui.model.Filter({filters:[d,n],and:true});this.orderSearchPopup.bindAggregation("items",{path:"/OrderHeaders",filters:d,template:new sap.m.DisplayListItem({label:"{OrderNo}",value:{path:"Customer",formatter:this.getCustomerName.bind(this)}})});this.getView().addDependent(this.orderSearchPopup);this.orderSearchPopup.open()},getCustomerName:function(e){return this.allMasterData.customers[e].CustomerCode+"-"+this.allMasterData.customers[e].Name},getMaterialPopup:function(){if(!this.matSearchPopup){this.matSearchPopup=new sap.ui.xmlfragment("victoria.fragments.popup",this);this.getView().addDependent(this.matSearchPopup);var e=this.getView().getModel("i18n").getProperty("matSearch");this.matSearchPopup.setTitle(e);this.matSearchPopup.bindAggregation("items",{path:"/Products",template:new sap.m.DisplayListItem({label:"{ProductCode}",value:"{ProductName}"})})}this.matSearchPopup.open()},getDialogPopup:function(){if(!this.oDialogPopup){this.oDialogPopup=new sap.ui.xmlfragment("idDialog","victoria.fragments.Dialog",this);this.getView().addDependent(this.oDialogPopup)}this.oDialogPopup.open()},getReasgnPopup:function(){if(!this.ReasgnPopup){this.ReasgnPopup=new sap.ui.xmlfragment("idReDialog","victoria.fragments.Dialog",this);this.getView().addDependent(this.ReasgnPopup)}this.ReasgnPopup.open()},getFormPopup:function(){if(!this.oFormPopup){this.oFormPopup=new sap.ui.xmlfragment("victoria.fragments.SimpleForm",this);this.getView().addDependent(this.oFormPopup);var e=this.getView().getModel("i18n").getProperty("customer");this.oFormPopup.setTitle(e)}this.oFormPopup.open()},getBatchPopup:function(){if(!this.oSuppPopup){this.oSuppPopup=new sap.ui.xmlfragment("victoria.fragments.popup",this);this.getView().addDependent(this.oSuppPopup);var e=this.getView().getModel("i18n").getProperty("customer");this.searchPopup.setTitle(e)}this.oSuppPopup.open()},getQuery:function(e){var t=e.getParameter("query");if(!t){t=e.getParameter("value")}return t},getSelectedKey:function(e,t,r){var t=e.getParameter("selectedItem").getValue();var r=e.getParameter("selectedItem").getLabel();var a=e.getParameter("selectedItem").getBindingContextPath();var s=this.getView().getModel().getProperty(a).id;return[t,r,s]},getObjListSelectedkey:function(e){debugger;var t=e.getParameter("selectedItem").getTitle();var r=e.getParameter("selectedItem").getIntro();var a=e.getParameter("selectedItem").getNumber();var s=e.getParameter("selectedItem").getBindingContextPath();var i=this.getView().getModel().getProperty(s).id;return[t,r,a,i]},getModel:function(e){return this.getOwnerComponent().getModel(e)},messagePoper:null,createMessagePopover:function(){var e=this;if(!this.messagePoper){this.messagePoper=sap.ui.xmlfragment("victoria.fragments.DependencyChecker",this);this.getView().addDependent(this.messagePoper);this.messagePoper.setModel(this.getOwnerComponent().getModel("local"),"local")}this.messagePoper.open()},toggleUiTable:function(e,t){debugger;if(this.toggleTableState===true){this._openFullScreen(e,t);this.toggleTableState=false;this.byId(e).setTooltip("exit fullScreen")}else{this._closeFullScreen(e,t);this.toggleTableState=true;this.byId(e).setTooltip("fullScreen")}var r=this.toggleTableState?"sap-icon://full-screen":"sap-icon://exit-full-screen";this.byId(e).setIcon(r)},_closeFullScreen:function(e,t){debugger;this.getView().byId(t).setVisible(true);this.getView().oParent.oParent._oMasterNav.setVisible(true)},_openFullScreen:function(e,t){debugger;this.getView().byId(t).setVisible(false);this.getView().oParent.oParent._oMasterNav.setVisible(false)},destroyMessagePopover:function(){if(this.messagePoper){this.messagePoper.destroy();this.messagePoper=null}},getErrorMessage:function(e){var t=[];var r;var a;if(e.statusText=="Unauthorized"){this.redirectLoginPage()}try{var t=e.responseText.split(".")[1];if(e.responseText.split(".")["length"]>2){t=e.responseText}if(!t){t=e.responseText.split(":")[1]}}catch(r){if(e.message){t=";"+e.message}else{return e.responseText.split(".")[1]}}t=t.split(";");var s=[];for(var i=0;i<t.length;i++){s.push({type:"Error",description:t[i]})}if(s){this.getOwnerComponent().getModel("local").setProperty("/messages",s);this.getOwnerComponent().getModel("local").setProperty("/messagesLength",s.length);this.createMessagePopover()}},handlevalidationDialogClose:function(){this.messagePoper.close();if(this.messagePoper){this.messagePoper.destroy();this.messagePoper=null}},handleGoldValidation:function(e){var t=parseFloat(e,10);if((t<3e4||t>8e4)&&t>0){var r=false;return r}else{var r=true;return r}},handleSilverValidation:function(e){var t=parseFloat(e,10);if((t<3e4||t>11e4)&&t>0){var r=false;return r}else{var r=true;return r}},setModel:function(e,t){return this.getView().setModel(e,t)},getResourceBundle:function(){return this.getOwnerComponent().getModel("i18n").getResourceBundle()},redirectLoginPage:function(e,t){debugger;var r=that.getView().getModel().getHeaders().Authorization;if(e=="X"&&t!="X"){$.post("/api/Users/logout?access_token="+r,{}).done(function(e,t){that.getView().getModel("local").setProperty("/Authorization","");that.getView().getModel().setHeaders({Authorization:""})}).fail(function(e,t,r){sap.m.MessageBox.error("Logout failed")});i.alert("Logout Successful")}else if(t!="X"){i.alert(that.resourceBundle.getText("Page11"))}window.top.location.href="/"},onNavBack:function(){var e=r.getInstance().getPreviousHash(),t=sap.ushell.Container.getService("CrossApplicationNavigation");if(e!==undefined||!t.isInitialNavigation()){history.go(-1)}else{this.getRouter().navTo("master",{},true)}},getEventBus:function(){return sap.ui.getCore().getEventBus()},getViewModel:function(){return new a({busy:false,delay:0,mode:"view",oldRec:"false",extendedMode:false})},clearData:function(){},onSwitchStateChange:function(e){},onAutoLoginCheck:function(e){},onDateFormatted:function(e){var t=e.getDate();var r=e.getMonth()+1;var a=e.getFullYear();if(t<10){t="0"+t}if(r<10){r="0"+r}return t+"."+r+"."+a},copyTextToClipboard:function(e){if(!navigator.clipboard){fallbackCopyTextToClipboard(e);return}navigator.clipboard.writeText(e).then(function(){console.log("Async: Copying to clipboard was successful!")},function(e){console.error("Async: Could not copy text: ",e)})},fallbackCopyTextToClipboard:function(e){var t=document.createElement("textarea");t.value=e;document.body.appendChild(t);t.focus();t.select();try{var r=document.execCommand("copy");var a=r?"successful":"unsuccessful";console.log("Fallback: Copying text command was "+a)}catch(e){console.error("Fallback: Oops, unable to copy",e)}document.body.removeChild(t)},onSystemHelp:function(e){},mapFieldsFromBaseToItem:function(e){var t=this.getView().getModel("local").getProperty("orderItemBase");if(e==="R"){}else{}},setVisible:function(e,t){var r=new sap.ui.model.json.JSONModel({rows1:true});this.setModel(r,"visModel");if(t){var a=this.getView().getModel("visModel");a.setProperty("/rows1",false)}else if(e.getParameter("name")==="sales"){var a=this.getView().getModel("visModel");a.setProperty("/rows1",false)}else if(e.getParameter("name")==="salesws"){var a=this.getView().getModel("visModel");a.setProperty("/rows1",true)}else if(e.getParameter("id")){if(e.getParameter("id").split("---")[1]==="idsales"){var a=this.getView().getModel("visModel");a.setProperty("/rows1",false)}else if(e.getParameter("id").split("---")[1].split("--")[0]==="idsales"){var a=this.getView().getModel("visModel");a.setProperty("/rows1",false)}}else if(e.getSource().getContent().getId()==="idsales"){var a=this.getView().getModel("visModel");a.setProperty("/rows1",false)}else if(e.getSource().getContent().getId()==="sales-page"){var a=this.getView().getModel("visModel");a.setProperty("/rows1",false)}},focusAndSelectNextInput:function(e,t){debugger;setTimeout(function(){var r=$(t);var a=r.toArray().filter(t=>t.id.includes(e));var s=r.index(a[0]);if(r[s+1]!=null){var i=r[s+1];i.focus();i.select()}},300)},ValueChangeMaterial:function(e){debugger;var t=e.getSource().getId().split("---")[1];if(t!==undefined){if(t.split("--")[0]==="idsales"){this.byId("Sales--idSaveIcon").setColor("red")}}var r=sap.ui.core.Fragment.byId("fr1","idSaveIndicator");if(r){r.setColor("red")}$(function(){$("input:text:first").focus();var e=$("input:text");e.bind("keypress",function(t){var r=t.which;if(r==13){t.preventDefault();var a=e.index(this)+1;$(":input:text:eq("+a+")").focus()}})});var a=this;var s=e.getSource().getParent().getBindingContext("orderItems");var i=this.getView().getModel("local").getProperty("/orderHeader");var o=null;if(!s){s=e.getSource().getParent().getBindingContext("materialPopupOrderItems");o=i.id;var l=e.getSource().mBindingInfos.value.binding.oContext.sPath;if(!o){var n=new sap.ui.model.Filter("OrderNo","EQ",i.OrderNo);a.ODataHelper.callOData(a.getOwnerComponent().getModel(),"/OrderHeaders","GET",{filters:[n]},{},a).then(function(e){debugger;o=e.results[e.results.length-1].id;l=l+"/OrderNo";a.getView().getModel("materialPopupOrderItems").setProperty(l,o)})}else{l=l+"/OrderNo";a.getView().getModel("materialPopupOrderItems").setProperty(l,o)}}var d=s.getModel("local");var u=e.getSource().getParent().getBindingContext("orderItems");if(!u){u=e.getSource().getParent().getBindingContext("materialPopupOrderItems")}var g=u.getPath();var p=d.getProperty(g+"/MaterialCode");var c=e.getSource().getId();var n=new sap.ui.model.Filter("ProductCode","EQ",p.toUpperCase());this.ODataHelper.callOData(this.getOwnerComponent().getModel(),"/Products","GET",{filters:[n]},{},this).then(function(e){console.log(e.results[0]);if(e.results[0]){if(c.includes("fr1")){a.focusAndSelectNextInput(c,"input[id*='fr1--id']")}else{a.focusAndSelectNextInput(c,"input[id*='---idsales--']")}}debugger;d.setProperty(g+"/Material",e.results[0].id);if(e.results[0].HindiName){d.setProperty(g+"/Description",e.results[0].HindiName)}else{d.setProperty(g+"/Description",e.results[0].ProductName)}d.setProperty(g+"/MaterialCode",e.results[0].ProductCode);if(e.results[0].Making){d.setProperty(g+"/Making",e.results[0].CustomerMaking?e.results[0].CustomerMaking:e.results[0].Making)}if(e.results[0].PricePerUnit){d.setProperty(g+"/MakingD",e.results[0].PricePerUnit)}if(e.results[0].Tunch){d.setProperty(g+"/Tunch",e.results[0].CustomerTunch?e.results[0].CustomerTunch:e.results[0].Tunch)}d.setProperty(g+"/Category",e.results[0].Category);d.setProperty(g+"/Type",e.results[0].Type);d.setProperty(g+"/Karat",e.results[0].Karat)}).catch(function(e){})},materialPopup:null,onFindMaterial:function(){debugger;var e=this;var t=this.getView().getModel("local").getProperty("/orderHeader");if(t.OrderNo!==0&&t.OrderNo!==""){if(!this.materialPopup){this.materialPopup=new sap.ui.xmlfragment("fr1","victoria.fragments.tableSelectDialog",this);this.getView().addDependent(this.materialPopup)}e.clearPopupScreen();var r=r=t.id;var a=null;if(!r){var a=new sap.ui.model.Filter("OrderNo","EQ",t.OrderNo);e.ODataHelper.callOData(e.getOwnerComponent().getModel(),"/OrderHeaders","GET",{filters:[a]},{},e).then(function(t){debugger;r=t.results[t.results.length-1].id;r="'"+r+"'";a=new sap.ui.model.Filter("OrderNo","EQ",r);e.ODataHelper.callOData(e.getOwnerComponent().getModel(),"/StockItems","GET",{filters:[a]},{},e).then(function(t){debugger;if(t.results.length>0){var r=e.getView().getModel("materialPopupOrderItems").getProperty("/popupItemsData");for(var a=0;a<t.results.length;a++){var s=e.allMasterData.materials[t.results[a].Material];r[a].MaterialCode=s.ProductCode;r[a].Qty=Math.abs(t.results[a].Qty);r[a].id=t.results[a].id;r[a].Description=s.HindiName||s.ProductName;r[a].OrderNo=t.results[a].OrderNo}e.getView().getModel("materialPopupOrderItems").setProperty("/popupItemsData",r)}var i=sap.ui.core.Fragment.byId("fr1","idSaveIndicator");if(i){i.setColor("green")}});setTimeout(function(){$("input[type='Number']").focus(function(){$(this).select()})},300);e.materialPopup.open()})}else{r="'"+r+"'";a=new sap.ui.model.Filter("OrderNo","EQ",r);e.ODataHelper.callOData(e.getOwnerComponent().getModel(),"/StockItems","GET",{filters:[a]},{},e).then(function(t){debugger;if(t.results.length>0){var r=e.getView().getModel("materialPopupOrderItems").getProperty("/popupItemsData");for(var a=0;a<t.results.length;a++){var s=e.allMasterData.materials[t.results[a].Material];r[a].MaterialCode=s.ProductCode;r[a].Qty=Math.abs(t.results[a].Qty);r[a].id=t.results[a].id;r[a].Description=s.HindiName||s.ProductName;r[a].OrderNo=t.results[a].OrderNo}e.getView().getModel("materialPopupOrderItems").setProperty("/popupItemsData",r)}var i=sap.ui.core.Fragment.byId("fr1","idSaveIndicator");if(i){i.setColor("green")}});setTimeout(function(){$("input[type='Number']").focus(function(){$(this).select()})},300);e.materialPopup.open()}}else{var s=e.getView().getModel("i18n").getResourceBundle().getText("orderValidation");i.show(s,{icon:i.Icon.ERROR,title:"Error",actions:[i.Action.OK],onClose:function(e){}})}},clearPopupScreen:function(){var e=this.getView().getModel("materialPopupOrderItems").getProperty("/popupItemsData");for(var t=0;t<e.length;t++){e[t].MaterialCode="";e[t].Qty="0";e[t].id="";e[t].Description="";e[t].OrderNo=""}this.getView().getModel("materialPopupOrderItems").setProperty("/popupItemsData",e)},onDialogClose:function(e){this.materialPopup.close()},validateValue:function(e){var t=sap.ui.core.Fragment.byId("fr1","dialogSave");if(!t){t=sap.ui.core.Fragment.byId("fr2","dialogSave")}if(e.getSource().getValue()<=0){debugger;e.getSource().setValueState(sap.ui.core.ValueState.Error);t.setEnabled(false)}else{e.getSource().setValueState(sap.ui.core.ValueState.None);t.setEnabled(true)}},onDialogSave:function(e){debugger;var t=this;var r=sap.ui.core.Fragment.byId("fr1","materialPopupTable");if(!r){r=sap.ui.core.Fragment.byId("fr2","materialPopupTable")}var a=r.getBinding("rows");var s=[];var i=t.getView().getModel("materialPopupOrderItems").getProperty("/popupItemsData");var o=false;var l=sap.ui.core.Fragment.byId("fr1","idSaveIndicator");if(!l){l=sap.ui.core.Fragment.byId("fr2","idSaveIndicator")}for(let e=0;e<a.getLength();e++){var t=this;var n=a.oList[e];if(n.id===""){if(n.MaterialCode!==""){if(l){l.setColor("red")}if(n.Qty>0){}else{o=true;break}}}}if(o===true){sap.m.MessageBox.error("Can't Save! Quantity should be greater than 0");e.getSource().setEnabled(false)}else{for(let e=0;e<a.getLength();e++){var t=this;var n=a.oList[e];if(n.id===""){if(n.MaterialCode!==""){if(n.Qty>0){var d={data:n};d.Date=this.getView().getModel("local").getProperty("/orderHeader/Date");d.Qty=Math.abs(d.Qty)*-1;this.ODataHelper.callOData(this.getOwnerComponent().getModel(),"/StockItems","POST",{},d,this).then(function(r){t.getView().setBusy(false);debugger;i[e].id=r.id;sap.m.MessageToast.show("Data Saved Successfully");if(l){l.setColor("green")}t.getView().getModel("materialPopupOrderItems").setProperty("/popupItemsData",i)}).catch(function(e){t.getView().setBusy(false);var r=t.getErrorMessage(e)})}}}}}},deleteReturnValues:function(e,t,r,a,s){debugger;var i=this;var o=i.getView().getModel("returnModel").getProperty("/TransData")[r].ReturnId;if(o){if(a==="idsales"){i.ODataHelper.callOData(i.getOwnerComponent().getModel(),"/OrderReturns('"+o+"')","DELETE",{},{},i)}else{i.ODataHelper.callOData(i.getOwnerComponent().getModel(),"/WSOrderReturns('"+o+"')","DELETE",{},{},i)}sap.m.MessageToast.show("Data Deleted Successfully")}i.deleteReturn(e,r);var s=i.getView().getModel("returnModel").getProperty("/TransData");s.splice(r,1);s.push({Type:"",Key:"",ReturnId:"",Weight:0,KWeight:0,Tunch:0,Qty:0,Bhav:0,Remarks:"",SubTotalS:0,SubTotalG:0,SubTotal:"",CreatedBy:"",CreatedOn:"",ChangedBy:"",ChangedOn:""});i.getView().getModel("returnModel").setProperty("/TransData",s)},onReturnValue:function(e){debugger;if(e.getSource().getId().split("---")[1].split("--")[0]=="idsales"){this.byId("Sales--idSaveIcon").setColor("red")}else if(e.getSource().getId().split("---")[1].split("--")[0]=="idsalesws"){this.byId("WSHeaderFragment--idSaveIcon").setColor("red")}var t=this.getView().byId("OrderReturn").getModel("returnModel").getProperty(e.getSource().getParent().getBindingContext("returnModel").getPath());var r=this.getView().getModel("local").getProperty("/CustomCalculations");var a=e.getParameter("selectedItem").getKey();this.defaultValuesLoad(e,t,r,a)},defaultValuesLoad:function(e,t,r,a){debugger;var s=this;var i=e.getSource().getParent().getId().split("---")[1].split("--")[0];if(a){t.Key=a}t.Weight="0";t.Tunch="0";t.KWeight="0";t.Quantity="0";t.Remarks="";t.Bhav="0";t.SubTotal="0";if(a==="OG"){t.Tunch="100";if(i==="idsales"){t.Bhav=r.results[0].GoldReturns}else{t.Bhav=r.results[0].GoldReturns1}}else if(a==="BG"){t.Tunch="100";if(i==="idsales"){t.Bhav=r.results[0].GoldReturns}}else if(a==="BS"){t.Tunch="100";if(i==="idsales"){t.Bhav=r.results[0].SilverReturns}}else if(a==="OS"){t.Tunch="100";if(i==="idsales"){t.Bhav=r.results[0].SilverReturns}else{t.Bhav=r.results[0].SilverReturns1}}else if(a==="KG"){if(i==="idsales"){t.Bhav=r.results[0].GoldReturns}}else if(a==="KS"){if(i==="idsales"){t.Bhav=r.results[0].SilverReturns}}else if(a==="CASH"){}s.getView().getModel("local").setProperty("/returnModel",t)},onReturnChange:function(e){debugger;if(e.getSource().getId().split("---")[1].split("--")[0]=="idsales"){this.byId("Sales--idSaveIcon").setColor("red");var t=this.getView().getModel("local").getProperty("/orderHeaderTemp");if(this.orderAmount===""){this.orderAmount=t.TotalOrderValue}}else if(e.getSource().getId().split("---")[1].split("--")[0]=="idsalesws"){this.byId("WSHeaderFragment--idSaveIcon").setColor("red")}var r=e.getSource().getParent().getBindingContext("returnModel").getPath();var a=this.getView().getModel("returnModel").getProperty(r);var s=e.getSource().getId().split("---")[1].split("--")[0];if(s==="idsales"){var i=this.getView().getModel("local").getProperty("/orderHeader")}else{}this.returnCalculation(e,i,a);this.finalBal=this.orderAmount-this.deduction;if(this.finalBal===0){var o=0}else{var o=this.getIndianCurr(this.finalBal)}this.getView().getModel("local").setProperty("/orderHeaderTemp/FinalBalance",o)},setReturnNewValue:function(e,t,r){if(t==="IdWeightR"){if(e.Weight!==r){e.Weight=r}}if(t==="IdKWeightR"){if(e.KWeight!==r){e.KWeight=r}}if(t==="IdTunchR"){if(e.Tunch!==r){e.Tunch=r}}if(t==="IdBhavR"){if(e.Bhav!==r){e.Bhav=r}}},getReturnFloatValue:function(e,t){if(e.Weight===""){var r=0;e.Weight=0}else if(e.Weight===0){var r=0;e.Weight=0}else{var r=e.Weight.toString();e.Weight=t.parse(r)}if(e.KWeight===""){var a=0;e.KWeight=0}else if(e.KWeight===0){var a=0;e.KWeight=0}else{var a=e.KWeight.toString();e.KWeight=t.parse(a)}if(e.Tunch===""){var s=0;e.Tunch=0}else if(e.Tunch===0){var s=0;e.Tunch=0}else{var s=e.Tunch.toString();e.Tunch=t.parse(s)}if(e.Bhav===""){var i=0;e.Bhav=0}else if(e.Bhav===0){var i=0;e.Bhav=0}else{var i=e.Bhav.toString();e.Bhav=t.parse(i)}},returnCalculation:function(e,t,r){debugger;if(e.getId()==="orderReload"){var a=this.getView().getModel("returnModel").getProperty(r);var s=r;var i=this.getView().byId("OrderReturn")._getVisibleColumns();n=e.viewId}else{var a=r;var o=e.getParameters().newValue;var l=e.getParameters().id.split("---")[1].split("--")[1].split("-")[0];var n=e.getSource().getId().split("---")[1].split("--")[0];var d=e.getSource().getParent();var i=d.getCells()}var u=new sap.ui.core.Locale("en-US");var g=sap.ui.core.format.NumberFormat.getFloatInstance(u);if(o){this.setReturnNewValue(a,l,o)}this.getReturnFloatValue(a,g);if(a.Key==="OG"||a.Key==="KG"||a.Key==="BG"){if(a.Key==="BG"){a.Tunch=100}var p=a.Bhav/10;var c=a.Weight-a.KWeight;var h=a.Tunch*c/100;var m=parseFloat(h).toFixed(3);var f=h*p;var v=parseFloat(f).toFixed(0);v=this.getIndianCurr(v);var y=this.getIndianCurr(f);if(a.SubTotal&&a.SubTotal!==""){var P=g.parse(a.SubTotal);this.deduction=f+this.deduction-P}else{this.deduction=f+this.deduction}var C=this.deduction;var w=this.getIndianCurr(C);if(s){a.SubTotal=y;if(n=="idsalesws"){a.SubTotal=v;if(f){a.SubTotalG=0;a.SubTotalS=0}else{a.SubTotal=0;a.SubTotalG=m;a.SubTotalS=0}}else{debugger;if(w==="0"||w===""){w="0"}this.getView().getModel("local").setProperty("/orderHeaderTemp/Deduction",w)}this.getView().byId("OrderReturn").getModel("returnModel").setProperty(s,a)}else{i[i.length-1].setText(y);if(n=="idsalesws"){i[i.length-1].setText(v);if(y){i[i.length-2].setText(0)}else{i[i.length-2].setText(m);i[i.length-3].setText(0)}}else{debugger;if(w==="0"||w===""){w="0"}this.getView().getModel("local").setProperty("/orderHeaderTemp/Deduction",w)}}}else if(a.Key==="OS"||a.Key==="KS"||a.Key==="BS"){if(a.Key==="BS"){a.Tunch=100}var p=a.Bhav/1e3;var c=a.Weight-a.KWeight;var b=a.Tunch*c/100;var M=parseFloat(b).toFixed(2);var f=b*p;var v=parseFloat(f).toFixed(0);v=this.getIndianCurr(v);var y=this.getIndianCurr(f);if(a.SubTotal&&a.SubTotal!==""){var P=g.parse(a.SubTotal);this.deduction=f+this.deduction-P}else{this.deduction=f+this.deduction}var C=this.deduction;var w=this.getIndianCurr(C);if(s){a.SubTotal=y;if(n=="idsalesws"){a.SubTotal=v;if(f){a.SubTotalG=0;a.SubTotalS=0}else{a.SubTotalS=M;a.SubTotalG=0;a.SubTotal=0}}else{debugger;if(w==="0"||w===""){w="0"}this.getView().getModel("local").setProperty("/orderHeaderTemp/Deduction",w)}this.getView().byId("OrderReturn").getModel("returnModel").setProperty(s,a)}else{i[i.length-1].setText(y);if(n=="idsalesws"){i[i.length-1].setText(v);if(f){i[i.length-3].setText(0);i[i.length-2].setText(0)}else{i[i.length-3].setText(M);i[i.length-2].setText(0);i[i.length-1].setText(0)}}else{debugger;if(w==="0"||w===""){w="0"}this.getView().getModel("local").setProperty("/orderHeaderTemp/Deduction",w)}}}else if(a.Key==="CASH"){var y=this.getIndianCurr(a.Bhav);var T=parseFloat(a.Bhav).toFixed(0);T=this.getIndianCurr(T);if(this.deduction!=""){if(a.SubTotal&&a.SubTotal!=""){var S=g.parse(a.SubTotal);this.deduction=this.deduction+a.Bhav-S}else{this.deduction=this.deduction+a.Bhav}}else{this.deduction=a.Bhav}var C=this.deduction;var w=this.getIndianCurr(C);if(n=="idsalesws"){}else{if(w==="0"||w===""){w="0"}this.getView().getModel("local").setProperty("/orderHeaderTemp/Deduction",w)}if(s){a.SubTotal=y;if(n=="idsalesws"){a.SubTotal=T}this.getView().byId("OrderReturn").getModel("returnModel").setProperty(s,a)}else{i[i.length-1].setText(y);if(n=="idsalesws"){i[i.length-1].setText(T)}}}},onRetItemValidation:function(){var e=this;var t=this.getView().getId().split("---")[1];var r=this.getView().getModel("returnModel").getProperty("/TransData");var a=e.getView().byId("OrderReturn");var s=a.getBinding("rows");var i=false;for(var o=0;o<s.getLength();o++){var l=s.oList[o];if(l.Key!==""){if(l.Key==="CASH"){if(l.Bhav===""||l.Bhav===0||l.Bhav==="0"){this.getView().setBusy(false);a.getRows()[o].getCells()[5].setValueState("Error");i=true}else{a.getRows()[o].getCells()[1].setValueState("None");this.getView().setBusy(false)}}else{if(l.Weight===""||l.Weight===0||l.Weight==="0"){this.getView().setBusy(false);a.getRows()[o].getCells()[1].setValueState("Error");i=true}else{r.Weight=l.Weight;a.getRows()[o].getCells()[1].setValueState("None");this.getView().setBusy(false)}debugger;if(l.Bhav===""||l.Bhav===0||l.Bhav==="0"){if(t=="idsalesws"&&(l.Key==="OG"||l.Key==="OS")||t=="idsales"){this.getView().setBusy(false);a.getRows()[o].getCells()[5].setValueState("Error");i=true}}else{r.Bhav=l.Bhav;a.getRows()[o].getCells()[5].setValueState("None");this.getView().setBusy(false)}if(l.Tunch===""||l.Tunch===0||l.Tunch==="0"){if((l.Key==="KG"||l.Key==="KS")&&t=="idsales"){this.getView().setBusy(false);a.getRows()[o].getCells()[3].setValueState("Error");i=true}else{r.Tunch=l.Tunch;a.getRows()[o].getCells()[3].setValueState("None");this.getView().setBusy(false)}if(t=="idsalesws"){this.getView().setBusy(false);a.getRows()[o].getCells()[3].setValueState("Error");i=true}}debugger;this.getView().getModel("returnModel").setProperty("/TransData",r)}}}return i},orderItem:function(e,t){this.setVisible(e,t);var r=new sap.ui.model.json.JSONModel;var a=[];for(var s=1;s<=20;s++){var i={OrderNo:"",itemNo:"",Material:"",MaterialCode:"",Description:"",Qty:"0",QtyD:"0",Weight:"0",WeightD:"0",Making:"0",MakingD:"0",Tunch:0,Remarks:"",SubTotal:"",SubTotalS:0,SubTotalG:0,Category:"",CreatedBy:"",CreatedOn:"",ChangedBy:"",ChangedOn:""};a.push(i)}r.setData({itemData:a});this.setModel(r,"orderItems")},materialPopupOrderItem:function(e,t){this.setVisible(e,t);var r=new sap.ui.model.json.JSONModel;var a=[];for(var s=1;s<=20;s++){var i={id:"",OrderNo:"",itemNo:"",MaterialCode:"",Description:"",Qty:"0",Date:""};a.push(i)}r.setData({popupItemsData:a});this.setModel(r,"materialPopupOrderItems")},hideDColumns:function(e){debugger;var t=this.getView().getModel("VisibleSet");debugger;if(t.getProperty("/set")===true){t.setProperty("/set",false)}else{t.setProperty("/set",true)}},onCustomerSelect:function(t,r,a){debugger;var s=this;if(t.getParameter("selectedItem")){var i=t.getParameter("selectedItem").getBindingContext().getObject();this.setCustomerIdAndCustomerName(i)}e.sap.delayedCall(100,this,function(){this.getView().byId("idCash").focus();this.getView().byId("idCash").$().find("input").select()})},onBookingCustomerSelect:function(e,t,r){debugger;var a=this;if(e.getParameter("selectedItem")){var s=e.getParameter("selectedItem").getBindingContext().getObject();this.setCustomerIdAndCustomerName(s)}},getCustomer:function(e){debugger;var t=this;var r=e.getSource();if(e.getParameter("value")){var a=e.getParameter("value").toLocaleUpperCase();var s=r.getBinding("suggestionItems").aLastContextData;var i=s.find(e=>{if(JSON.parse(e).CustomerCode===a){return s}});var o=JSON.parse(i);this.setCustomerIdAndCustomerName(o)}},setCustomerIdAndCustomerName:function(e){debugger;this.getView().getModel("local").setProperty("/selectedCustomer",e);var t=this;var r=e.City;var a=e.CustomerCode;var s=e.Name;var i=this.getView().byId("Sales--customerId");var o=this.getView().byId("idCust");var l=this.getView().byId("idCustomerCode");var n=this.getView().byId("WSHeaderFragment--customerId");var d=this.getView().byId("idCoCustomer");var u=this.getView().byId("idCustNo");if(d){this.getView().byId("idCoCustomer").setValue(a);this.getView().getModel("local").setProperty("/customerOrder/Customer",this.allMasterData.customersId[a].id);this.getView().getModel("local").setProperty("/coTemp/CustomerCode",a);var g=new sap.ui.model.Filter("Customer","EQ","'"+this.allMasterData.customersId[a].id+"'");this.getView().byId("idCoTable").getBinding("items").filter(g)}else if(n){this.getView().byId("WSHeaderFragment--customerId").setValue(a);this.getView().getModel("local").setProperty("/WSOrderHeader/Customer",e.id);this.getView().getModel("local").setProperty("/orderHeaderTemp/CustomerId",a);this.getView().getModel("local").setProperty("/orderHeaderTemp/CustomerName",s)}else if(l){this.getView().byId("idCustomerCode").setValue(a);this.getView().getModel("local").setProperty("/BookingDetail/Customer",e.id);this.getView().getModel("local").setProperty("/BookingDetail/CustomerId",a);this.getView().getModel("local").setProperty("/BookingDetail/CustomerName",s);var p=this.getView().getModel("local").getProperty("/BookingDetail");if(this.getView().byId("idRb1").getSelected()){p.Type="Silver"}else{p.Type="Gold"}if(p.Customer===""){var c=new sap.ui.model.Filter("Type","EQ",p.Type);this.getView().byId("idTable").getBinding("items").filter(c);this.getView().byId("idBookingDlvTable").getBinding("items").filter(c)}else{var h=new sap.ui.model.Filter("Customer","EQ","'"+p.Customer.split("'")+"'");var c=new sap.ui.model.Filter("Type","EQ",p.Type);var g=new sap.ui.model.Filter({filters:[h,c],and:true});this.getView().byId("idTable").getBinding("items").filter([g]);this.getView().byId("idBookingDlvTable").getBinding("items").filter([g])}var t=this;$.post("/getTotalBookingCustomer",{myData:p}).then(function(e){console.log(e);debugger;if(p.Type="Silver"){t.byId("idBTQ").setText(parseFloat(e.BookedQtyTotal.toFixed(3)))}else{t.byId("idBTQ").setText(parseFloat(e.BookedQtyTotal.toFixed(2)))}t.byId("idBTQ").getText();parseFloat(t.byId("idBTQ").getText());if(parseFloat(t.byId("idBTQ").getText())>0){t.byId("idBTQ").setState("Success");debugger}else{t.byId("idBTQ").setState("Warning")}t.byId("idBAP").setText(parseFloat(e.BookedAvgPriceTotal.toFixed(0)));t.byId("idBAP").getText();parseFloat(t.byId("idBAP").getText());if(parseFloat(t.byId("idBAP").getText())>0){t.byId("idBAP").setState("Success");debugger}else{t.byId("idBAP").setState("Warning")}});var m=t;$.post("/getTotalDeliveredCustomer",{myData:p}).then(function(e){console.log(e);debugger;if(p.Type="Silver"){m.byId("idDTQ").setText(parseFloat(e.DeliveredQtyTotal.toFixed(3)))}else{m.byId("idDTQ").setText(parseFloat(e.DeliveredQtyTotal.toFixed(2)))}m.byId("idDTQ").getText();if(parseFloat(t.byId("idDTQ").getText())>0){m.byId("idDTQ").setState("Success");debugger}else{m.byId("idDTQ").setState("Warning")}m.byId("idDAP").setText(parseFloat(e.DeliveredAvgPriceTotal.toFixed(0)));m.byId("idDAP").getText();if(parseFloat(t.byId("idDAP").getText())>0){m.byId("idDAP").setState("Success");debugger}else{m.byId("idDAP").setState("Warning")}})}else if(o){this.getView().byId("idCust").setValue(a);this.getView().byId("idEntryDownload").setEnabled(true);this.getView().getModel("local").setProperty("/EntryData/Customer",e.id);this.getView().getModel("local").setProperty("/EntryData/CustomerCity",r);this.getView().getModel("local").setProperty("/entryHeaderTemp/customerId",a);this.getView().getModel("local").setProperty("/EntryData/customerName",s);var p=this.getView().getModel("local").getProperty("/EntryData");var g=new sap.ui.model.Filter("Customer","EQ","'"+p.Customer+"'");this.getView().byId("idTable").getBinding("items").filter(g);this.customerId=e.id;$.post("/getTotalEntryCustomer",{Customer:p.Customer}).then(function(e){console.log(e);debugger;if(e.CashTotal===null){t.byId("idTC").setText("0")}else{t.byId("idTC").setText(parseFloat(e.CashTotal.toFixed(2)))}t.byId("idTC").getText();parseFloat(t.byId("idTC").getText());if(parseFloat(t.byId("idTC").getText())>0){t.byId("idTC").setState("Success");debugger}else{t.byId("idTC").setState("Warning")}t.getView().byId("idG").setText(parseFloat(e.GoldTotal.toFixed(3)));t.byId("idG").getText();parseFloat(t.byId("idG").getText());if(parseFloat(t.byId("idG").getText())>0){t.byId("idG").setState("Success");debugger}else{t.byId("idG").setState("Warning")}t.getView().byId("idS").setText(parseFloat(e.SilverTotal.toFixed(2)));t.byId("idS").getText();parseFloat(t.byId("idS").getText());parseFloat(t.byId("idS").getText()).toFixed(3);if(parseFloat(parseFloat(t.byId("idS").getText()).toFixed(3))>0){t.byId("idS").setState("Success");debugger}else{t.byId("idS").setState("Warning")}})}else if(u){debugger;if(a){var f=this.getView().getModel("local").getProperty("/kachhiHeaderTemp");f.CustomerId=a;f.CustomerName=s;this.getView().getModel("local").setProperty("/kachhiHeaderTemp",f)}var p=this.getView().getModel("local").getProperty("/kacchiData");p.Customer=e.id;this.customerId=p.Customer;this.getView().getModel("local").setProperty("/kacchiData",p);this.getView().byId("idCustNo").setValue(a);this.getView().getModel("local").setProperty("/kacchiData/Customer",e.id);this.getView().getModel("local").setProperty("/kachhiHeaderTemp/customerId",a);var g=new sap.ui.model.Filter("Customer","EQ","'"+p.Customer+"'");this.getCustDataFromDB(g)}else{this.getView().byId("Sales--customerId").setValue(a);this.getView().getModel("local").setProperty("/orderHeader/Customer",e.id);this.getView().getModel("local").setProperty("/orderHeaderTemp/CustomerId",a)}},onMaterialSelect:function(e){debugger;var t=this;var r=e.getSource().getId().split("---")[1];if(r!==undefined){if(r.split("--")[0]==="idsales"){this.byId("Sales--idSaveIcon").setColor("red")}}var a=sap.ui.core.Fragment.byId("fr1","idSaveIndicator");if(a){a.setColor("red")}var s=e.getParameter("selectedItem").getModel().getProperty(e.getParameter("selectedItem").getBindingContext().getPath());var i=e.getSource().getParent().getBindingContext("orderItems");var o=null;var l=this.getView().getModel("local").getProperty("/orderHeader");if(!i){i=e.getSource().getParent().getBindingContext("materialPopupOrderItems");o=l.id;var n=e.getSource().mBindingInfos.value.binding.oContext.sPath;if(!o){var d=new sap.ui.model.Filter("OrderNo","EQ",l.OrderNo);t.ODataHelper.callOData(t.getOwnerComponent().getModel(),"/OrderHeaders","GET",{filters:[d]},{},t).then(function(e){debugger;o=e.results[e.results.length-1].id;n=n+"/OrderNo";t.getView().getModel("materialPopupOrderItems").setProperty(n,o)})}else{n=n+"/OrderNo";t.getView().getModel("materialPopupOrderItems").setProperty(n,o)}}var u=i.getModel();var g=e.getSource().getParent().getBindingContext("orderItems");if(!g){g=e.getSource().getParent().getBindingContext("materialPopupOrderItems")}var p=g.getPath();u.setProperty(p+"/Material",s.id);if(s.HindiName){u.setProperty(p+"/Description",s.HindiName)}else{u.setProperty(p+"/Description",s.ProductName)}if(s.Making){u.setProperty(p+"/Making",s.CustomerMaking?s.CustomerMaking:s.Making)}else{u.setProperty(p+"/Making",0)}if(s.PricePerUnit){u.setProperty(p+"/MakingD",s.PricePerUnit)}else{u.setProperty(p+"/MakingD",0)}u.setProperty(p+"/Category",s.Category);u.setProperty(p+"/Type",s.Type);u.setProperty(p+"/Karat",s.Karat);if(s.Tunch){u.setProperty(p+"/Tunch",s.CustomerTunch?s.CustomerTunch:s.Tunch)}else{u.setProperty(p+"/Tunch",0)}var c=e.getSource().getId();if(c.includes("fr1")){t.focusAndSelectNextInput(c,"input[id*='fr1--id']")}else{t.focusAndSelectNextInput(c,"input[id*='---idsales--']")}},onTableExpand:function(e){debugger;var t=this.getView().oParent.oParent;var r=t.getMode();if(r=="ShowHideMode"){debugger;t.setMode(sap.m.SplitAppMode.HideMode)}else{t.setMode(sap.m.SplitAppMode.ShowHideMode)}},orderCustomCalculations:function(){var e=this;e.ODataHelper.callOData(e.getOwnerComponent().getModel(),"/CustomCalculations","GET",{},{},this).then(function(t){e.getView().getModel("local").setProperty("/CustomCalculations",t);e.getView().getModel("local").setProperty("/orderHeader/GoldBhav22",t.results[0].Second);e.getView().getModel("local").setProperty("/orderHeader/GoldBhav20",t.results[0].First);e.getView().getModel("local").setProperty("/orderHeader/GoldBhav",t.results[0].Gold);e.getView().getModel("local").setProperty("/orderHeader/SilverBhav",t.results[0].Silver)}).catch(function(t){e.getView().getModel("local").setProperty("/orderHeader/GoldBhav22",0);e.getView().getModel("local").setProperty("/orderHeader/GoldBhav20",0);e.getView().getModel("local").setProperty("/orderHeader/GoldBhav",0);e.getView().getModel("local").setProperty("/orderHeader/SilverBhav",0)})},onSuggest:function(e){debugger;var t=e.getParameter("suggestValue").toLocaleUpperCase();var r=[];if(t){r.push(new u("CustomerCode",g.Contains,t));r.push(new u("Name",g.Contains,t));e.getSource().getBinding("suggestionItems").filter(new u({filters:r,and:false}));e.getSource().getBinding("suggestionItems").refresh(true);e.getSource().getBinding("suggestionItems").isSuspended();e.getSource().getBinding("suggestionItems").resume();var a=new sap.ui.model.Sorter({path:"CustomerCode",descending:false});e.getSource().getBinding("suggestionItems").sort(a)}},orderReturn:function(e,t){this.setVisible(e,t);var r=new sap.ui.model.json.JSONModel;var a=[];for(var s=1;s<=5;s++){var i={Type:"",Key:"",ReturnId:"",Weight:0,KWeight:0,Tunch:0,Qty:0,Bhav:0,Remarks:"",SubTotalS:0,SubTotalG:0,SubTotal:"",CreatedBy:"",CreatedOn:"",ChangedBy:"",ChangedOn:""};a.push(i)}r.setData({TransData:a});this.setModel(r,"returnModel")}})});