sap.ui.define(["victoria/controller/BaseController","sap/m/MessageBox","sap/m/MessageToast","sap/ui/core/routing/History"],function(t,e,i,a){"use strict";return t.extend("victoria.controller.pendingOrders",{onInit:function(){t.prototype.onInit.apply(this);var e=this.getRouter();e.getRoute("pendingOrders").attachMatched(this._onRouteMatched,this)},getRouter:function(){return sap.ui.core.UIComponent.getRouterFor(this)},_onRouteMatched:function(){var t=this;t.getView().getModel("local").setProperty("/stockMaint/Date",new Date);this.getView().byId("idDate").setDateValue(new Date)},onSubmit:function(t){$(function(){$("input:text:first").focus();var t=$("input:text");t.bind("keypress",function(e){var i=e.which;if(i==13){e.preventDefault();var a=t.index(this)+1;$(":input:text:eq("+a+")").focus()}})})},decimalvalidator:function(t){if(t.mParameters.id==="__component0---idpendingOrders--idweight"){$(function(){$("input").on("input.idweight",function(t){if(t.currentTarget.id=="__component0---idpendingOrders--idweight-inner"){this.value=this.value.match(/^[+-]?\d{0,8}(\.\d{0,3})?/)[0]}})})}},onMaterialSelect:function(t){var e=this;var i=t.getParameter("selectedItem").getModel().getProperty(t.getParameter("selectedItem").getBindingContext().getPath());var a=this.getView().getModel("local").getProperty("/stockMaint");i.ProductCode;i.ProductName;i.Type;this.getView().byId("idMat").setValue(i.ProductCode);this.getView().byId("idMatText").setText(i.ProductName+"-"+i.Type);this.getView().getModel("local").setProperty("/stockMaint/Product",t.getParameter("selectedItem").getBindingContext().getPath().split("'")[1]);this.getView().getModel("local").getProperty("/stockMaint",a);var s=new sap.ui.model.Filter("Product","EQ","'"+a.Product+"'");this.getView().byId("idTable").getBinding("items").filter(s);$.post("/getTotalStockProduct",{Product:a.Product}).then(function(t){console.log(t);e.byId("idQty").setText(t.QuantityTotal);e.byId("idWt").setText(t.WeightTotal);if(parseFloat(e.byId("idQty").getText())>0){e.byId("idQty").setState("Success")}else{e.byId("idQty").setState("Warning")}if(parseFloat(e.byId("idWt").getText())>0){e.byId("idWt").setState("Success")}else{e.byId("idWt").setState("Warning")}})},onSend:function(t){var e=this;e.getView().setBusy(true);var i=this.getView().getModel("local").getProperty("/stockMaint");i.Date=this.getView().byId("idDate").getDateValue();i.Description=this.getView().byId("idMatText").getText();i.Description=i.Description.split("-")[0];i.Quantity=this.getView().byId("idqty").getValue();var a=this.getView().byId("idweight").getValue();var s=parseFloat(this.byId("idweight").getValue());if(this.getView().byId("idMatText").getText().split("-")[1]==="Gold"){var r=s.toFixed(3);var d=parseFloat(r);i.Weight=d}else if(this.getView().byId("idMatText").getText().split("-")[1]==="Silver"){var o=s.toFixed(2);var n=parseFloat(o);i.Weight=n}i.Remarks=this.getView().byId("idRemarks").getValue();this.ODataHelper.callOData(this.getOwnerComponent().getModel(),"/stockMaints","POST",{},i,this).then(function(t){e.getView().setBusy(false);sap.m.MessageToast.show(e.resourceBundle.getText("Data"));e.onClear()}).catch(function(t){e.getView().setBusy(false);var i=e.getErrorMessage(t)});var g=this.getView().byId("idQty").getText();var l=parseFloat(this.byId("idQty").getText());var a=this.getView().byId("idqty").getValue();var s=parseFloat(this.byId("idqty").getValue());var y=l+s;this.byId("idQty").setText(parseFloat(y));var c=this.byId("idQty").getText();if(parseFloat(c)>0){e.byId("idQty").setState("Success")}else{e.byId("idQty").setState("Warning")}var g=this.getView().byId("idWt").getText();var l=parseFloat(this.byId("idWt").getText());var a=this.getView().byId("idweight").getValue();var s=parseFloat(this.byId("idweight").getValue());if(this.getView().byId("idMatText").getText().split("-")[1]==="Gold"){var u=s.toFixed(3);var h=parseFloat(u);var y=l+h}else if(this.getView().byId("idMatText").getText().split("-")[1]==="Silver"){var p=s.toFixed(2);var I=parseFloat(p);var y=l+I}this.byId("idWt").setText(parseFloat(y));var c=this.byId("idWt").getText();if(parseFloat(c)>0){e.byId("idWt").setState("Success")}else{e.byId("idWt").setState("Warning")}},onClear:function(){this.getView().byId("idDate").setDateValue(new Date);this.getView().byId("idqty").setValue("0");this.getView().byId("idRemarks").setValue("");this.getView().byId("idweight").setValue("0")},onUpdateFinished:function(t){var e=t.getSource();var i=e.getItems();var a=i.length;var s=this.getView().getModel("i18n").getProperty("product");this.getView().byId("idTitle").setText(s+"("+a+")");for(var r=0;r<a;r++){var d=e.getItems()[r].getCells()[2].getText();var o=this.allMasterData.materials[d];e.getItems()[r].getCells()[1].setText(o.ProductCode)}},onDelete:function(){var t=this;sap.m.MessageBox.confirm(t.resourceBundle.getText("DELETE11"),{title:"Confirm",actions:[sap.m.MessageBox.Action.OK,sap.m.MessageBox.Action.CANCEL],styleClass:"",onClose:function(e){if(e==="OK"){var i=t.getView().byId("idTable").getSelectedItems();var a=0;var s=0;for(var r=0;r<i.length;r++){var d=i[r].getBindingContext().sPath;t.ODataHelper.callOData(t.getOwnerComponent().getModel(),d,"DELETE",{},{},t);sap.ui.getCore().byId("__component0---idpendingOrders--idTable").getModel().refresh(true);var o=i[r].getBindingContext().getObject().Quantity;var n=i[r].getBindingContext().getObject().Weight;if(o){a+=a+o-a}if(n){s+=s+n-s}}var g=t.byId("idQty").getText();var l=parseFloat(g);var y=l-a;t.byId("idQty").setText(parseFloat(y));t.byId("idQty").getText();parseFloat(t.byId("idQty").getText());if(parseFloat(t.byId("idQty").getText())>0){t.byId("idQty").setState("Success")}else{t.byId("idQty").setState("Warning")}var c=t.byId("idWt").getText();var u=parseFloat(c);var h=u-s;t.byId("idWt").setText(parseFloat(h));t.byId("idWt").getText();parseFloat(t.byId("idWt").getText());if(parseFloat(t.byId("idWt").getText())>0){t.byId("idWt").setState("Success")}else{t.byId("idWt").setState("Warning")}}}})}})});
//# sourceMappingURL=pendingOrders.controller.js.map